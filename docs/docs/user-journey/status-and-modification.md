---
sidebar_position: 3
---

# 유저 여정 상태 관리

여정은 운영 상태에 따라 진입/실행/수정 가능 여부가 달라집니다. 상태를 올바르게 전환하면 안전하게 배포·수정할 수 있습니다.

## 상태 종류

| 상태     | 새로운 세션 진입 | 진행 중 세션 실행         | 메시지 발송 | 통계 집계          | 노드/구조 수정 |
|----------|------------------|---------------------------|-------------|--------------------|----------------|
| **활성** | 가능             | 계속 진행                | 수행        | 집계됨             | 불가           |
| **일시중지** | 불가         | 중단 후 대기 (재활성화 시 재개) | 중단        | 집계 안 됨 (진행 없음) | 가능           |
| **비활성** | 불가           | 즉시 이탈 처리            | 중단        | 이탈로 집계        | 가능           |

- 활성: 여정이 정상 동작하는 상태입니다.
- 일시중지: 새로운 진입은 막고, 진행 중 세션을 현재 노드에서 멈춰 대기시킵니다. 다시 활성화하면 멈춘 지점부터 재개됩니다.
- 비활성: 운영 중단 상태입니다. 모든 진행 중 세션을 이탈 처리하며, 재개해도 기존 세션은 복구되지 않습니다.

## 상태 전환 시 동작

### 활성 → 일시중지

- 신규 진입: 중단
- 진행 중: 현재 노드에서 대기(보류)
- 재활성화 시: 대기 중 세션이 원래 흐름을 이어서 실행
   
### 활성 → 비활성

- 신규 진입: 중단
- 진행 중: 즉시 이탈 처리 (해당 세션 종료)
- 재활성화 시: 새 세션만 시작 가능 (기존 세션 복구 불가)
  
### 일시중지 → 활성

- 대기 중 세션이 재개
- 수정 사항이 있다면 재개 시점부터 새로운 흐름을 따릅니다
- 예: 일시중지 중 노드 A→B를 A→C로 바꿨다면, 재개 후 A에 있던 세션은 C로 진행
  
### 비활성 → 활성

- 모든 과거 세션은 종료 상태 그대로 유지
- 새로운 조건을 만족하는 유저만 다시 진입

::: warning 주의
시간에 민감한 대기(예: “15분 대기 후 메시지”)가 일시중지 기간 동안 만료되면, 재활성화 시 해당 세션은 정책에 따라 즉시 다음 단계로 이동하거나 이탈될 수 있습니다. 설계 시 여유 시간을 고려하세요.
:::

## 수정 가능 조건

- 수정은 일시중지 또는 비활성 상태에서만 가능
- 노드 추가/삭제/이동
- 조건(시점/대상/재진입/이탈) 변경
- 메시지 콘텐츠/채널 설정 변경
- 활성 상태에서는 구조 수정 불가 (안정성 보장)

### 권장 운영 패턴
- 배포 전: 비활성에서 구성 → 테스트 실행(샌드박스/테스트 세그먼트) → 활성 전환
- 소규모 수정: 일시중지로 전환 → 수정 → 활성로 재개 (세션 보존)
- 대규모 변경/리스크 큰 변경: 새로운 여정 복제 → 수정 → 점진 활성화(대상 일부) → 완전 전환 후 기존 여정 비활성

### 문제 예방 체크리스트
- 일시중지 중 대기 만료 시 처리 정책 확인
- 비활성 전환 시 모든 진행 중 세션 이탈됨을 이해하고 수행
- 재진입 규칙이 변경되면 예상치 못한 반복 진입/미진입이 발생하지 않는지 검증
- 변경 후 최초 1~2회차는 대상 규모 제한으로 점검(관찰 창구 마련)